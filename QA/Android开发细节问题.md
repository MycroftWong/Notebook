# Android开发细节问题

## 场景：主页通常有一个ViewPager，断网状态下，第一次进入，至少有两个Fragment同时加载，如果每个加载都使用Toast提示，那么可能出现多个Toast提示的问题

引出第一个问题，也是体验好坏非常重要的问题。

从下面**加载错误的提示时机**的分析，我们将加载错误的场景组合，分为两类（忽略数据逻辑错误）

- 第一次进入页面时，加载失败（通常是断网）<br/> 通用解决办法：使用一个“刷新界面”“覆盖”正常显示的界面，不使用```Toast```等进行提示。这个刷新界面至少需要一个按钮，点击后重新模拟第一次进入时加载数据

- 请求更多数据、或刷新当前页面时，加载失败（即界面上本来就有数据）<br/>解决方案：1. 可以使用Toast提示 2. 如果界面是一个列表，可以使用footer来显示加载失败的信息，同时附加点击加载更多的标识

### 加载错误的提示时机

#### 加载失败的分类

1. 断网、弱网络，总之网络数据请求失败，通常是抛出异常

2. 加载的数据逻辑错误，如签名错误。这种错误实现上本不应该出现。

#### 错误出现时机的分类

1. 第一次进入页面时

2. 在请求更多数据，或刷新当前页面时


### 统一封装

常用的地方莫过于```Activity```和```Fragment```, 刷新界面在加载成功过一次之后应该隐藏或移除掉。

