# 融云直播聊天室使用分析

## 概念

- 只有登录过的用户才能加入聊天室。暂时想到的方式是未登录的用户使用同一个fake用户来加入聊天室，但是要保证不排斥的情况，暂时没有验证。
- 聊天室实际上只是弹幕的功能，并没有视频的功能。而视频直播通常是与视频功能拆开的（从弹幕延迟可以感受出来），融云并没有直播推流、拉流的功能，只提供了直播播放器的功能。要实现推流、拉流，需要另外处理。

## 步骤

### 1. 与融云SDK连接

客户端通过APP Server向SDK Server获取融云用户系统的用户token, 然后使用token连接绑定SDK。

具体APP Server的用户系统与SDK用户系统如何绑定由APP Server来处理，客户端只需要拿到token, 再与SDK绑定即可。

### 2. 加入聊天室

比纯IM模块简单的是，直播聊天室是与主播进行绑定的，呈现的是一对一的关系。而纯IM模块则需要处理单聊、群聊、讨论组的情况。

聊天室与主播账号绑定，则从APP Server获取主播的直播聊天室ID，加入该聊天室即可。需要处理的只有两点：1. 新消息的处理（界面显示问题） 2. 发送消息

### 3. 退出聊天室

在退出界面时，处理退出聊天室的逻辑即可。注意避免内存泄露。

### 4. 视频直播功能

通常而言使用第三方SDK来实现则比较简单，推流+拉流的方式。